# TinyWeb开发日记



##### 调试

###### 多线程调试

在本实验涉及了对于多线程程序的调试，其实与单线程一样，在我们需要查看的地方添加断点即可。新创建的线程在遇到断点后便会自动停止，这时通过‘thread’指令即可跳转至不同线程逐步调试

###### 数组过大

在Ubuntu系统中，C/C++代码如果初始化了一个过大的数组，编译时可能会遇到不同于Windows上的Mingw编译错误提示，例如“relocation truncated to fit"等等，总之或许看不到明显的数组过大的报错提示。

注：该报错英文直译为重定向失败，即链接器无法找到目标文件某项的具体地址。而在linux下的gcc编译过程中很可能出现在定义了一个过大的数组情况下。若编译器未能识别并制止超大数组的分配，就可能导致其他的

##### 问题总结：

测试时不清楚代理服务(正向)的逻辑，导致测试方法错误。正确测试流程为浏览器访问“http://proxy-server/http://real-server/path"

注：浏览器可能会额外自动发送“url/favicon.ico/"来获取网站的标签图标，这可能会导致程序崩溃。

##### 附加知识

`curl -v`参数会输出请求中访问的路由信息，方便确定是否设置成功，请求有没有代理

curl -v http://proxy-server/ http://real-server/path 可以用来测试代理服务程序

`netstat -nat | grep 1024` 查看与代理端口相链接的端口

`lsof -i :1024` 查看端口相关的进程

##### 多网站部署

猜想：对于在一个远程服务器上部署多个网站的方法，可以考虑将不同的服务绑定到不同的内部端口，将代理服务绑定到唯一的外部端口，但是客户端访问时需要知道具体的端口...（不现实）

理想的方法是每一个服务对应一个域名，代理解析域名时将请求转发到对应端口。

​                                                                                                                                            
